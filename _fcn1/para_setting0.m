%% setting parameter ; initialization 

% setting parameter for bandpass feature extraction
%   para.band = [4 8 12 16 24 48 64];  
    para.band = [1 4 8 12 18 30 45];   %CTG: changed the band range
    para.nband = length(para.band) - 1;
    para.nstartband = 1; %start from theta band - removin delta band which is noisy
    
%   para.bandWt = ones(length(para.band),1);  %lzq: create matrix (7, 1) (7 rows and 1 column) % CTG: removed 

    % para.winLen is the window length for feature extraction from EEG
    %para.winLen = 3;   %window length (seconds)
    para.winLen = 2;   %sec
    para.overlap = 50; %percentage
    para.maFeat = 1;%9; % averaging frames
    para.maStep = 1;%5; % shifting frames
    para.fs = 256;

    %para.dataDir= '..\data\2018_01_EEG_Recording\';
    para.dataDir= '.\data\';
    para.eegfile=dir([para.dataDir '*.csv']);
    para.nsubject=length(para.eegfile);
    
%   Class ID
    para.ClassID = [0,1];
    
%   CV folds
    para.nFold = 10;
    
%==Preprocessing Bandpass-filter signals (0.3-45 Hz)
    fOrder = 4;               
    [para.preFiltB,para.preFiltA] = butter(fOrder,[0.3 45]/(para.fs/2),'bandpass');    

%parameters for artifact removal
    %para.kCompMat = [6,10,16,20,50]; % this can be optimised
    %para.kCompMat = [16,26,36,46]; % this can be optimised
    %para.kCompMat = [4,6,8,10,12,14,16,18,20]; 
    para.kCompMat = [22,24,26,28,30,32,34,36,38,40,42,44,48,52]; % this can be optimised
    para.kCompMat2 =  para.kCompMat/2;
    para.nComp = length( para.kCompMat);% number of smoothed component
    
 % post processing to smooth scores   
    para.smoothscore = 10;
    
% bandpass filters
%   Delta Band (1-4Hz):
para.BPNumSec(1)= 7;                                             

para.BPCoe{1} = [
1  -1.9996288113898675   1  1  -1.970678492670487   0.98124185659790164
1  -1.9843941083593173   1  1  -1.99518449737547    0.99572722173265393
1  -1.9997356280506082   1  1  -1.9233139676096491  0.93444264473183458
1  -1.9781226190200072   1  1  -1.9853950121012676  0.98589542003065278
1  -1.9999052056533044   1  1  -1.9709370314512096  0.97140652310675601
1  -1.939574831982845    1  1  -1.8522189535287943  0.86356064390918641
1   0                   -1  1  -1.8808566006003127  0.88312593358244484];
                                                                       
para.BPGain{1} = [
0.75701130410533457                                                    
0.75701130410533457                                                    
0.6722666683349231                                                     
0.6722666683349231                                                     
0.44613561218524111                                                    
0.44613561218524111                                                    
0.058437033208777578                                                   ];                                                                      

%. Theta Band (4-8Hz)
para.BPNumSec(2)= 7;                                             

para.BPCoe{2} = [
1  -1.9925674091830181   1  1  -1.9405173640379598  0.97993709410966412
1  -1.9503203155643714   1  1  -1.9809739348262407  0.99022045660679081
1  -1.9939969977121625   1  1  -1.8913735185704463  0.93051313671209113
1  -1.9386490914989534   1  1  -1.9573255061168042  0.96629530554045484
1  -1.9971645235613529   1  1  -1.9155218688526485  0.92510885715268643
1  -1.8722035917039273   1  1  -1.8260726699095802  0.86065030956083566
1   0                   -1  1  -1.8331156793968122  0.85094125551483446];
                                                                       
para.BPGain{2} = [
0.75603116184194208                                                    
0.75603116184194208                                                    
0.66891043737961398                                                    
0.66891043737961398                                                    
0.44256863950801417                                                    
0.44256863950801417                                                    
0.07452937224258277                                                    ];

%   Alpha Band (8-12Hz)
para.BPNumSec(3)= 7;                                             

para.BPCoe{3} = [
1  -1.9677522180861722   1  1  -1.893065005426708   0.98135086448067899
1  -1.8976386571578105   1  1  -1.9509493763306323  0.98784442084305135
1  -1.9719168829690188   1  1  -1.8486231966927784  0.935485921351915  
1  -1.8827837689414955   1  1  -1.9218252384116852  0.95790145970379692
1  -1.9833777911107042   1  1  -1.7917458441636678  0.87007831997814478
1  -1.8053531266809124   1  1  -1.8707163960165012  0.90842482680662517
1   0                   -1  1  -1.7933456449569654  0.84652347611435252];
                                                                       
para.BPGain{3} = [
0.75590093580401652                                                    
0.75590093580401652                                                    
0.66845747134216793                                                    
0.66845747134216793                                                    
0.44211605294016998                                                    
0.44211605294016998                                                    
0.076738261942823766                                                   ];

%   Low-Beta Band (12-18Hz)
para.BPNumSec(4)= 7;                                             

para.BPCoe{4} = [
1  -1.9278383192708048   1  1  -1.7762365358519356  0.97227366644773561
1  -1.7721821057831599   1  1  -1.8993734083742657  0.98171555366697361
1  -1.9371925983081704   1  1  -1.7144430198244971  0.90516699636589426
1  -1.7398755341806338   1  1  -1.8572543639456116  0.9371547472150028 
1  -1.9629215514647698   1  1  -1.642235508869534   0.81171122004939356
1  -1.5759355868752298   1  1  -1.7825314933666419  0.86501307825713691
1   0                   -1  1  -1.6630284864278941  0.7776369129223254 ];
                                                                       
para.BPGain{4} = [                                                       
0.75402582804427565                                                    
0.75402582804427565                                                    
0.66167409434966218                                                    
0.66167409434966218                                                    
0.43628446723718262                                                    
0.43628446723718262                                                    
0.11118154353883733                                                    ];

%   High-Beta Band (18-30Hz)
para.BPNumSec(5)= 7;                                             

para.BPCoe{5} = [
1  -1.8458324211269148   1  1  -1.4206279877600123  0.94477946962104864
1  -1.3693434839013543   1  1  -1.785070067873364   0.96577073798199309
1  -1.8701865519068841   1  1  -1.3223981956049711  0.81727668634824946
1  -1.2687798066657936   1  1  -1.7136073597897052  0.88490831941987791
1  -1.9311582640917071   1  1  -1.5855781877086952  0.75861963637927643
1  -0.8002015368858616   1  1  -1.2331591624005218  0.65145083450075947
1   0                   -1  1  -1.3439863902709159  0.59890361270906944];
                                                                       
para.BPGain{5} = [                                                       
0.75104943241028055                                                    
0.75104943241028055                                                    
0.64745311414057083                                                    
0.64745311414057083                                                    
0.43316048813319791                                                    
0.43316048813319791                                                    
0.20054819364546525                                                    ];

%   Gamma Band (30-45Hz)
para.BPNumSec(6)= 7;                                             

para.BPCoe{6} = [
1  -1.5569095112507523     1  1  -0.85470335571808409  0.93899512656841388
1  -0.75194607529499335    1  1  -1.4577041289412254   0.9543707383446639 
1  -1.6134490290487853     1  1  -1.3820906527337939   0.84824843464600108
1  -0.61760465965236255    1  1  -0.78707014431898736  0.79983537414684514
1  -1.7717216016096049     1  1  -1.2360844647952356   0.69169324628564866
1  -0.068848047065401485   1  1  -0.75615386842277976  0.61811896087399676
1   0                     -1  1  -0.94488036424578736  0.53410426488946972];
                                                                          
para.BPGain{6} = [                                                       
0.75092381018165899                                                       
0.75092381018165899                                                       
0.64396818825347213                                                       
0.64396818825347213                                                       
0.43673144372417028                                                       
0.43673144372417028                                                       
0.23294786755526517                                                       ];

%1Hz low pass filter for feature extraction
para.LPNumSec = 3;                                             

para.LPCoe = [
1  -1.998547503313771   1  1  -1.989494958847225   0.99019102330323583
1  -1.9972904563676599  1  1  -1.9650270073865623  0.96591239505928839
1  -1.9798638609353583  1  1  -1.9344109011198536  0.93563475517894301];

para.LPGain = [ 
0.47921930742427477                                                   
0.32676634624308765                                                   
0.060778983257939442                                                  ];

% %2Hz low pass
% para.LPNumSec = 4;                                             
% 
% para.LPCoe = [
% 1  -1.9960874534835416  1  1  -1.9859181280964873  0.98846700901756535
% 1  -1.9945581271484274  1  1  -1.9572339995382184  0.96031394009523718
% 1  -1.987831661330052   1  1  -1.9103661105757477  0.91478499856945583
% 1  -1.9034071868026814  1  1  -1.8479733042879201  0.85437514531383407];
%                                                                       
% para.LPGain = [ 
% 0.65146341656412698                                                   
% 0.56597069446942161                                                   
% 0.36314636809226103                                                   
% 0.066276577045504992  ];                                                
